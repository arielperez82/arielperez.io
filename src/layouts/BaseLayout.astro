---
import '@/styles/global.css'

import { SEO } from 'astro-seo'
import { Schema } from 'astro-seo-schema'

import { SITE_TITLE } from '@/consts'

export interface Props {
  title: string
  description: string
  image?: string
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  schema?: any //Allow pages to pass custom schema (Schema.org types are complex)
}

const { title, description, image, schema } = Astro.props

const tinybirdHost = import.meta.env.PUBLIC_TINYBIRD_HOST

// Default Person schema for homepage, can be overridden per page
const defaultPersonSchema = {
  '@context': 'https://schema.org',
  '@type': 'Person',
  name: 'Ariel Pérez',
  alternateName: 'Ariel Perez',
  jobTitle:
    'Strategic Product & Technology Leader | Fractional CTO/CPTO | Product & Technology Strategy Advisor',
  description:
    '20+ years building and leading product and engineering teams. I write, speak, and consult on adaptive leadership, fluid organizations, and the intersection of technology and human systems.',
  url: 'https://www.arielperez.io',
  image: 'https://www.arielperez.io/assets/profile.jpg',
  sameAs: [
    'https://www.linkedin.com/in/arielxperez',
    'https://twitter.com/arielxperez',
    'https://github.com/arielperez82',
    'https://www.adaptivealchemist.com'
  ],
  knowsAbout: [
    'Adaptive Organizations',
    'Fluid Teams',
    'Systems Thinking',
    'Product Engineering',
    'Organizational Transformation',
    'AI & Real-time Data Systems'
  ],
  alumniOf: [
    {
      '@type': 'Organization',
      name: 'Tinybird'
    },
    {
      '@type': 'Organization',
      name: 'Split Software'
    },
    {
      '@type': 'Organization',
      name: 'JP Morgan Chase'
    }
  ],
  worksFor: {
    '@type': 'Organization',
    name: 'Tinybird',
    jobTitle: 'Head of Product & Technology, Field CTO'
  }
}

const pageSchema = schema || defaultPersonSchema
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <SEO
      title={title}
      description={description}
      openGraph={{
        basic: {
          title,
          type: 'website',
          image: image || 'https://www.arielperez.io/assets/profile.jpg'
        },
        optional: {
          description,
          siteName: SITE_TITLE
        }
      }}
      twitter={{
        creator: '@arielxperez',
        card: 'summary_large_image'
      }}
      extend={{
        link: [
          { rel: 'preconnect', href: 'https://fonts.googleapis.com' },
          {
            rel: 'preconnect',
            href: 'https://fonts.gstatic.com',
            crossorigin: ''
          },
          {
            rel: 'preconnect',
            href: 'https://www.adaptivealchemist.com',
            crossorigin: ''
          },
          {
            rel: 'preconnect',
            href: tinybirdHost,
            crossorigin: ''
          },
          {
            rel: 'stylesheet',
            href: 'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap'
          },
          // Apple Touch Icon
          { rel: 'apple-touch-icon', href: '/favicon/icon-180x180.png' },
          // Standard favicons
          {
            rel: 'icon',
            type: 'image/png',
            sizes: '16x16',
            href: '/favicon/favicon-16x16.png'
          },
          {
            rel: 'icon',
            type: 'image/png',
            sizes: '32x32',
            href: '/favicon/favicon-32x32.png'
          },
          {
            rel: 'icon',
            type: 'image/svg+xml',
            href: '/favicon.svg'
          },
          // Microsoft Tile
          {
            rel: 'msapplication-TileImage',
            href: '/favicon/icon-512x512.png'
          },
          // Web App Manifest
          { rel: 'manifest', href: '/favicon/site.webmanifest' }
        ],
        meta: [
          { name: 'mobile-web-app-capable', content: 'yes' },
          // Apple specific
          { name: 'apple-mobile-web-app-status-bar-style', content: 'default' },
          { name: 'apple-mobile-web-app-title', content: title },
          // Microsoft specific
          { name: 'msapplication-TileColor', content: '#18181b' },
          { name: 'msapplication-config', content: '/browserconfig.xml' },
          // Theme color for mobile browsers
          { name: 'theme-color', content: '#18181b' },
          {
            name: 'theme-color',
            content: '#ffffff',
            media: '(prefers-color-scheme: light)'
          },
          {
            name: 'theme-color',
            content: '#18181b',
            media: '(prefers-color-scheme: dark)'
          },
          // Author meta for disambiguation
          {
            name: 'author',
            content: 'Ariel Pérez - Engineering Leader & Systems Thinker'
          }
        ]
      }}
    />
    <Schema item={pageSchema} />
  </head>
  <body class="bg-white font-sans text-gray-900">
    <slot />
  </body><script>
    import analytics from '../scripts/analytics'

    document.addEventListener('DOMContentLoaded', () => {
      // Track initial page view
      analytics.page()
    })
  </script>
</html>
